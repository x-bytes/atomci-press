(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{212:function(s,a,n){"use strict";n.r(a);var t=n(0),e=Object(t.a)({},(function(){var s=this.$createElement;this._self._c;return this._m(0)}),[function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"二进制部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二进制部署"}},[s._v("#")]),s._v(" 二进制部署")]),s._v(" "),n("h2",{attrs:{id:"前置条件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[s._v("#")]),s._v(" 前置条件")]),s._v(" "),n("ul",[n("li",[s._v("请准备一台 linux 环境，2cx4Gx50G;")]),s._v(" "),n("li",[s._v("mysql "),n("code",[s._v("5.7.8+")])]),s._v(" "),n("li",[s._v("jenkins "),n("code",[s._v("v2.0+")])]),s._v(" "),n("li",[s._v("harbor "),n("code",[s._v("v1.6.0+")])]),s._v(" "),n("li",[s._v("kubernetes "),n("code",[s._v("v1.12.0+")])])]),s._v(" "),n("h2",{attrs:{id:"安装流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装流程"}},[s._v("#")]),s._v(" 安装流程")]),s._v(" "),n("h3",{attrs:{id:"_1-下载安装包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载安装包"}},[s._v("#")]),s._v(" 1.下载安装包")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# amd64")]),s._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/go-atomci/atomci-press/releases/download/1.0.0/atomci-linux_amd64.tgz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# arm64")]),s._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/go-atomci/atomci-press/releases/download/1.0.0/atomci-linux_amd64.tgz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_2-安装包目录结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装包目录结构"}},[s._v("#")]),s._v(" 2. 安装包目录结构")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("---- amd64   # arch\n |__ atomci             # 后端服务端程序\n |__ app.conf.sample    # 后端的示例配置文件\n |__ dist.tgz           # 前端静态文件\n |__ atomci-nginx.conf  # 前端nginx配置文件\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_3-应用配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-应用配置"}},[s._v("#")]),s._v(" 3.应用配置")]),s._v(" "),n("ol",[n("li",[s._v("解压安装包")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$ tar -zxvf  atomci-linux_amd64.tgz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ol",[n("li",[n("p",[s._v("服务端配置")]),s._v(" "),n("ul",[n("li",[s._v("修改"),n("code",[s._v("[db]")]),s._v("的配置，将"),n("code",[s._v("url")]),s._v("改为自己环境内的 mysql 信息")]),s._v(" "),n("li",[s._v("修改"),n("code",[s._v("[jwt]")]),s._v("的配置，将 "),n("code",[s._v("secret")]),s._v(" 改为自定义的随机字符串，保证系统的安全性")]),s._v(" "),n("li",[s._v("修改"),n("code",[s._v("[atomci]")]),s._v("的配置， 将"),n("code",[s._v("url")]),s._v("改为部署主机的 IP 及端口信息")])])])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 拷贝应用的示例配置文件\n$ cp conf/app.conf.sample  conf/app.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 创建数据库并指定字符集\n> CREATE DATABASE atomci CHARACTER SET utf8mb4;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("前端 nginx 配置及启动")])]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),n("ol",[n("li",[s._v("此处使用的是 nginx 的默认路径"),n("code",[s._v("/usr/share/nginx/html")]),s._v(", 也可以根据需求修改自定义的路径；")]),s._v(" "),n("li",[s._v("请确保你部署的服务器，nginx 配置会包含 "),n("code",[s._v("include /etc/nginx/conf.d/*.conf")]),s._v("， 否则请将\n"),n("code",[s._v("atomci-nginx.conf")]),s._v(" 移至相应可以被 nginx 识别到的路径。")])])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$ tar -zxvf dist.tgz -C  /usr/share/nginx/html\n\n# 拷贝应用的nginx配置文件\n$ cp atomci-nginx.conf   /etc/nginx/conf.d/\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_4-应用启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-应用启动"}},[s._v("#")]),s._v(" 4.应用启动")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查nginx语法")]),s._v("\n$ nginx -t\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启nginx，使新增的前端配置生效")]),s._v("\n$ nginx -s reload\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅启动服务端")]),s._v("\n$ ./atomci\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"_5-应用初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-应用初始化"}},[s._v("#")]),s._v(" 5.应用初始化")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/go-atomci/atomci-press/releases/download/1.0.0/cli\n$ ./cli init --token"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("token-get-from-sysuser-table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("blockquote",[n("p",[s._v("仅需要执行一次即可，注意在启动 "),n("code",[s._v("atomci")]),s._v("应用服务之后，执行初始化.")])]),s._v(" "),n("h3",{attrs:{id:"_6-应用访问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-应用访问"}},[s._v("#")]),s._v(" 6.应用访问")]),s._v(" "),n("blockquote",[n("p",[s._v("根据提示访问 AtomCI 系统 "),n("code",[s._v("http://ip:8081")]),s._v(" 验证安装结果, 默认用户名密码: "),n("code",[s._v("admin")]),s._v("/"),n("code",[s._v("123456")])])]),s._v(" "),n("h2",{attrs:{id:"附录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[s._v("#")]),s._v(" 附录")]),s._v(" "),n("h3",{attrs:{id:"应用示例配置及参数说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#应用示例配置及参数说明"}},[s._v("#")]),s._v(" 应用示例配置及参数说明")]),s._v(" "),n("div",{staticClass:"language-conf line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('# app default setting\n[default]\nappname = atomci\nhttpport = 8080\nrunmode = prod\ncopyrequestbody = true\n\n\n# db settings\n[DB]\nurl = root:root@tcp(127.0.0.1:3306)/atomci?charset=utf8mb4\ndebug = false\nrowsLimit = 5000\nmaxIdelConns = 100\nmaxOpenConns = 200\n\n# jwt secret \n[jwt]\nsecret = changeme\n\n# build/deploy callback\n[atomci]\nurl = http://localhost:8081\n\n\n# jenkins default jnlp/ kaniko image defined.\n[defaultImages]\njnlpImageAddr = 10.10.2.60:5000/library/jenkins:jnlp-debug\nkanikoImageAddr = 10.10.2.60:5000/library/kaniko-executor:latest\n\n[log]\nlogfile = "log/atomci.log"\nlevel = 7\nseparate = ["error"]\n\n\n[k8s]\nconfigPath = ./conf/k8sconfig\n\n# ldap settings\n[ldap]\nhost = ldap.xxx.com\nport = 389\nbindDN = ldap@xx.com\nbindPassword = Xxx..,\nuserFilter = (samaccountname=%s)\nbaseDN = OU=Xxx,DC=xx,DC=com\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br")])])])}],!1,null,null,null);a.default=e.exports}}]);